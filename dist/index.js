(function(c,y){typeof exports=="object"&&typeof module<"u"?y(exports):typeof define=="function"&&define.amd?define(["exports"],y):(c=typeof globalThis<"u"?globalThis:c||self,y(c.InteractiveFormEmbedder={}))})(this,(function(c){"use strict";const y="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let w=(d=21)=>{let t="",i=crypto.getRandomValues(new Uint8Array(d|=0));for(;d--;)t+=y[i[d]&63];return t};/*! js-cookie v3.0.5 | MIT */function f(d){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)d[s]=i[s]}return d}var g={read:function(d){return d[0]==='"'&&(d=d.slice(1,-1)),d.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(d){return encodeURIComponent(d).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function u(d,t){function i(n,e,r){if(!(typeof document>"u")){r=f({},t,r),typeof r.expires=="number"&&(r.expires=new Date(Date.now()+r.expires*864e5)),r.expires&&(r.expires=r.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var a in r)r[a]&&(o+="; "+a,r[a]!==!0&&(o+="="+r[a].split(";")[0]));return document.cookie=n+"="+d.write(e,n)+o}}function s(n){if(!(typeof document>"u"||arguments.length&&!n)){for(var e=document.cookie?document.cookie.split("; "):[],r={},o=0;o<e.length;o++){var a=e[o].split("="),b=a.slice(1).join("=");try{var h=decodeURIComponent(a[0]);if(r[h]=d.read(b,h),n===h)break}catch{}}return n?r[n]:r}}return Object.create({set:i,get:s,remove:function(n,e){i(n,"",f({},e,{expires:-1}))},withAttributes:function(n){return u(this.converter,f({},this.attributes,n))},withConverter:function(n){return u(f({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(d)}})}var m=u(g,{path:"/"});typeof window<"u"&&(window.ifLayer=window.ifLayer||[]);const l=class l{constructor(t){this.widgets=new Map,this.ifLayerProxy=null,t&&this.addWidget(t),this.processWidgetLayer(),this.setupIfLayerWatcher(),this.initializeDataAttributeWidgets()}shouldShowPopup(t){const i=`if-popup-${t}`;return m.get(i)===void 0}markPopupAsShown(t){const i=`if-popup-${t}`;m.set(i,"1",{expires:1})}static getInstance(){return l.instance||(l.instance=new l),l.instance}addWidget(t){if(t.type==="page-body"){const i=`${t.id}-${t.type}-${w()}`;this.widgets.set(i,t),this.initializeWidget(t)}else{const i=`${t.id}-${t.type}`;if(this.widgets.has(i)){console.warn(`Widget with id ${t.id} and type ${t.type} already exists`);return}this.widgets.set(i,t),this.initializeWidget(t)}}removeWidget(t,i){if(i==="page-body"){const s=[];this.widgets.forEach((n,e)=>{n.id===t&&n.type===i&&s.push(e)}),s.forEach(n=>{const e=this.widgets.get(n);e&&(this.destroyWidget(e),this.widgets.delete(n))})}else{const s=`${t}-${i}`,n=this.widgets.get(s);n&&(this.destroyWidget(n),this.widgets.delete(s))}}reinitialize(){this.widgets.forEach(t=>{this.destroyWidget(t)}),this.widgets.forEach(t=>{this.initializeWidget(t)})}static createInlineWidget(t,i="614px",s="300px",n){const e=document.createElement("iframe"),r=n||"https://if-form-staging.up.railway.app";e.src=`${r}/${t}`,e.width=i,e.height=s,e.style.maxWidth="100%",e.style.width=i,e.style.height=s,e.style.border="none",e.setAttribute("data-widget-id",t);const o=document.currentScript;return o&&o.parentNode?o.parentNode.insertBefore(e,o):document.body.appendChild(e),e}processWidgetLayer(){if(typeof window<"u"&&window.ifLayer&&window.ifLayer.length>0){const t=[...window.ifLayer];window.ifLayer=[],t.forEach(i=>{this.addWidget(i)})}}setupIfLayerWatcher(){typeof window>"u"||(this.ifLayerProxy=new Proxy(window.ifLayer,{set:(t,i,s)=>{const n=Reflect.set(t,i,s);return typeof i=="number"&&s&&typeof s=="object"&&this.addWidget(s),i==="length"&&Array.isArray(t)&&t.filter((r,o)=>o>=t.length-s).forEach(r=>{r&&typeof r=="object"&&this.addWidget(r)}),n}}),window.ifLayer=this.ifLayerProxy)}initializeWidget(t){switch(t.type){case"page-body":this.createPageBodyEmbed(t);break;case"float-button":this.createFloatButtonEmbed(t);break;case"pop-up":this.createPopUpEmbed(t);break}}destroyWidget(t){document.querySelectorAll(`[data-widget-id="${t.id}"]`).forEach(s=>{s.remove()})}createPageBodyEmbed(t){if(!t.container){console.error(`Container is required for page-body widget ${t.id}`);return}const i=document.querySelectorAll(t.container);if(i.length===0){console.error(`Container element not found for selector: ${t.container}`);return}const s=this.createIframe(t.id,"614px","300px",t.iframeSrc);s.setAttribute("data-widget-id",t.id),i.forEach(n=>{n.appendChild(s)})}createFloatButtonEmbed(t){const i=document.createElement("button");i.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="54" height="54" viewBox="0 0 54 54" fill="none"><rect width="54" height="54" rx="16" fill="#312DF6"/><path fill-rule="evenodd" clip-rule="evenodd" d="M11.1176 28C11.1176 36.2843 18.2284 43 27 43C35.7716 43 42.8824 36.2843 42.8824 28H45C45 37.3888 36.9411 45 27 45C17.0589 45 9 37.3888 9 28H11.1176Z" fill="white"/><rect x="9" y="19" width="13" height="2" fill="white"/><rect x="32" y="19" width="13" height="2" fill="white"/><rect x="32" y="12" width="2" height="8" fill="white"/><rect x="37" y="14" width="2" height="6" fill="white"/></svg>
    `,i.style.width="54px",i.style.height="54px",i.style.padding="0",i.style.position="fixed",i.style.bottom="20px",i.style.right="20px",i.style.zIndex="10000",i.style.color="white",i.style.border="none",i.style.cursor="pointer",i.style.backgroundColor="transparent",i.style.transition="all 0.3s ease",i.style.animation="ifScale 5s infinite",i.setAttribute("data-widget-id",t.id);const s=document.createElement("style");s.textContent=`
      @keyframes ifScale {
        0%, 80%, 100% {
          transform: scale(1);
        }
        20% {
          transform: scale(1.1);
        }
        40% {
          transform: scale(1.05);
        }
      }
    `,document.head.appendChild(s),i.addEventListener("mouseenter",()=>{i.style.transform="translateY(-2px)",i.style.animation="none"}),i.addEventListener("mouseleave",()=>{i.style.transform="scale(1)",i.style.animation="ifScale 5s infinite"});const n=document.createElement("div");n.style.position="fixed",n.style.bottom="90px",n.style.right="20px",n.style.zIndex="10001",n.style.display="none",n.style.background="white",n.style.borderRadius="8px",n.style.padding="12px",n.style.boxShadow="0 10px 30px rgba(0, 0, 0, 0.3)",n.setAttribute("data-widget-id",t.id);const e=document.createElement("button");e.innerHTML="&times;",e.style.position="absolute",e.style.top="5px",e.style.right="5px",e.style.background="none",e.style.border="none",e.style.fontSize="24px",e.style.cursor="pointer",e.style.color="#666",e.style.lineHeight="1",e.style.width="30px",e.style.height="30px",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.borderRadius="50%",e.style.transition="background-color 0.2s ease",e.addEventListener("mouseenter",()=>{e.style.background="#f0f0f0"}),e.addEventListener("mouseleave",()=>{e.style.background="transparent"});const r=this.createIframe(t.id,"614px","300px",t.iframeSrc);n.appendChild(e),n.appendChild(r),i.addEventListener("click",()=>{n.style.display="block",i.style.animation="none"}),e.addEventListener("click",()=>{n.style.display="none",i.style.animation="ifScale 5s infinite"}),document.body.appendChild(i),document.body.appendChild(n)}createPopUpEmbed(t){if(!this.shouldShowPopup(t.id))return;const i=t.timeout?t.timeout*1e3:3e3;setTimeout(()=>{const s=document.createElement("div");s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.background="rgba(0, 0, 0, 0.7)",s.style.zIndex="10002",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.style.animation="ifFadeIn 0.3s ease",s.setAttribute("data-widget-id",t.id);const n=document.createElement("div");n.style.position="relative",n.style.background="white",n.style.borderRadius="12px",n.style.padding="20px",n.style.boxShadow="0 20px 60px rgba(0, 0, 0, 0.4)",n.style.animation="ifSlideIn 0.3s ease",n.style.maxWidth="90vw",n.style.maxHeight="90vh";const e=document.createElement("button");e.innerHTML="&times;",e.style.position="absolute",e.style.top="5px",e.style.right="5px",e.style.background="none",e.style.border="none",e.style.fontSize="28px",e.style.cursor="pointer",e.style.color="#666",e.style.lineHeight="1",e.style.width="30px",e.style.height="30px",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.borderRadius="50%",e.style.transition="background-color 0.2s ease",e.addEventListener("mouseenter",()=>{e.style.background="#f0f0f0"}),e.addEventListener("mouseleave",()=>{e.style.background="transparent"});const r=this.createIframe(t.id,"614px","300px",t.iframeSrc);n.appendChild(e),n.appendChild(r),s.appendChild(n);const o=document.createElement("style");o.textContent=`
        @keyframes ifFadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes ifSlideIn {
          from { transform: translateY(-50px); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
      `,document.head.appendChild(o),e.addEventListener("click",()=>{s.remove()}),s.addEventListener("click",a=>{a.target===s&&s.remove()}),document.body.appendChild(s),this.markPopupAsShown(t.id)},i)}createIframe(t,i,s,n){const e=document.createElement("iframe"),r=n||"https://if-form-staging.up.railway.app";return e.src=`${r}/${t}`,e.width=i,e.height=s,e.style.maxWidth="100%",e.style.width=i,e.style.height=s,e.style.border="none",e}initializeDataAttributeWidgets(){document.querySelectorAll("[data-if-id]").forEach(i=>{const s=i.getAttribute("data-if-id");if(s){const n=i.getAttribute("data-if-type"),e=i.getAttribute("data-if-timeout"),r=i.getAttribute("data-if-iframe-src");let o;if(n==="page-body")o={id:s,type:"page-body",container:`[data-if-id="${s}"][data-if-type="page-body"]`,iframeSrc:r||void 0};else if(n==="float-button")o={id:s,type:"float-button",iframeSrc:r||void 0};else if(n==="pop-up")o={id:s,type:"pop-up",timeout:Number(e||10),iframeSrc:r||void 0};else{console.warn(`Unknown widget type for data-if-id: ${s}`);return}this.addWidget(o),i.removeAttribute("data-if-id"),i.removeAttribute("data-if-type"),i.removeAttribute("data-if-timeout"),i.removeAttribute("data-if-iframe-src")}})}};l.instance=null;let p=l;(function(){typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new p}):new p)})(),c.Embedder=p,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})}));
